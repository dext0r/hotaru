alert:
  fridge_is_hot:
    name: 'Fridge is hot'
    message: >
      ðŸ”¥ Ð¥Ð¾Ð»Ð¾Ð´Ð¸Ð»ÑŒÐ½Ð¸Ðº ÐºÐ°Ð¶ÐµÑ‚ÑÑ Ð¿ÐµÑ€ÐµÐ³Ñ€ÐµÐ»ÑÑ: {{ states('sensor.fridge_temperature') }} Â°C
    done_message: >
      â˜ƒï¸ Ð¥Ð¾Ð»Ð¾Ð´Ð¸Ð»ÑŒÐ½Ð¸Ðº Ð¾ÑÑ‚Ñ‹Ð»: {{ states('sensor.fridge_temperature') }} Â°C
    entity_id: binary_sensor.fridge_overheated
    state: 'on'
    repeat: 60
    notifiers:
      - dextor

  freezer_is_hot:
    name: 'Freezer is hot'
    message: >
      ðŸ”¥ ÐœÐ¾Ñ€Ð¾Ð·Ð¸Ð»ÑŒÐ½Ð¸Ðº ÐºÐ°Ð¶ÐµÑ‚ÑÑ Ð¿ÐµÑ€ÐµÐ³Ñ€ÐµÐ»ÑÑ: {{ states('sensor.freezer_temperature') }} Â°C
    done_message: >
      â˜ƒï¸ ÐœÐ¾Ñ€Ð¾Ð·Ð¸Ð»ÑŒÐ½Ð¸Ðº Ð¾ÑÑ‚Ñ‹Ð»: {{ states('sensor.freezer_temperature') }} Â°C
    entity_id: binary_sensor.freezer_overheated
    state: 'on'
    repeat: 60
    notifiers:
      - dextor

automation:
  - id: fridge_door_alert
    alias: 'Fridge: Door alert'
    trigger:
      - platform: state
        entity_id: binary_sensor.fridge_door
        id: 2m
        to: 'on'
        for:
          minutes: 2

      - platform: state
        entity_id: binary_sensor.fridge_door
        to: 'on'
        for:
          minutes: 4

      - platform: state
        entity_id: binary_sensor.fridge_door
        to: 'on'
        for:
          minutes: 10

      - platform: state
        entity_id: binary_sensor.fridge_door
        to: 'on'
        for:
          minutes: 15
    action:
      - if:
          - condition: trigger
            id: 2m
        then:
          - service: notify.dextor
            data:
              message: ðŸ§Š Ð—Ð°ÐºÑ€Ð¾Ð¹ Ñ…Ð¾Ð»Ð¾Ð´Ð¸Ð»ÑŒÐ½Ð¸Ðº!
        else:
          - service: script.yandex_station_tts
            data:
              target: all
              type: alert
              text: ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒ Ñ…Ð¾Ð»Ð¾Ð´Ð¸Ð»ÑŒÐ½Ð¸Ðº, ÐºÐ°Ð¶ÐµÑ‚ÑÑ Ð¾Ð½ Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚

  - id: fridge_temperature_alert
    alias: 'Fridge: Temperature alert'
    trigger:
      - platform: numeric_state
        entity_id: sensor.fridge_temperature
        above: 16
        for:
          minutes: 4

      - platform: numeric_state
        entity_id: sensor.fridge_temperature
        above: 16
        for:
          minutes: 25
    action:
      - service: script.yandex_station_tts
        data:
          target: all
          type: alert
          text: Ð’ Ñ…Ð¾Ð»Ð¾Ð´Ð¸Ð»ÑŒÐ½Ð¸ÐºÐµ Ð¾Ñ‡ÐµÐ½ÑŒ Ð¶Ð°Ñ€ÐºÐ¾, Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑŒ Ñ‡Ñ‚Ð¾ Ñ‚Ð°Ð¼ ÐºÐ°Ðº

  - id: freezer_door_alert
    alias: 'Freezer: Door alert'
    trigger:
      - platform: state
        entity_id: binary_sensor.freezer_door
        id: 2m
        to: 'on'
        for:
          minutes: 2

      - platform: state
        entity_id: binary_sensor.freezer_door
        to: 'on'
        for:
          minutes: 4

      - platform: state
        entity_id: binary_sensor.freezer_door
        to: 'on'
        for:
          minutes: 10

      - platform: state
        entity_id: binary_sensor.freezer_door
        to: 'on'
        for:
          minutes: 15
    action:
      - if:
          - condition: trigger
            id: 2m
        then:
          - service: notify.dextor
            data:
              message: ðŸ§Š Ð—Ð°ÐºÑ€Ð¾Ð¹ Ð¼Ð¾Ñ€Ð¾Ð·Ð¸Ð»ÑŒÐ½Ð¸Ðº!
        else:
          - service: script.yandex_station_tts
            data:
              target: all
              type: alert
              text: ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒ Ð¼Ð¾Ñ€Ð¾Ð·Ð¸Ð»ÑŒÐ½Ð¸Ðº, ÐºÐ°Ð¶ÐµÑ‚ÑÑ Ð¾Ð½ Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚

  - id: freezer_temperature_alert
    alias: 'Freezer: Temperature alert'
    trigger:
      - platform: numeric_state
        entity_id: sensor.freezer_temperature
        above: 16
        for:
          minutes: 4

      - platform: numeric_state
        entity_id: sensor.freezer_temperature
        above: 16
        for:
          minutes: 25
    action:
      - service: script.yandex_station_tts
        data:
          target: all
          type: alert
          text: Ð’ Ð¼Ð¾Ñ€Ð¾Ð·Ð¸Ð»ÑŒÐ½Ð¸ÐºÐµ Ð¾Ñ‡ÐµÐ½ÑŒ Ð¶Ð°Ñ€ÐºÐ¾, Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑŒ Ñ‡Ñ‚Ð¾ Ñ‚Ð°Ð¼ ÐºÐ°Ðº

template:
  binary_sensor:
    - name: Fridge Overheated
      state: >
        {{ states('sensor.fridge_temperature')|float >= 11 }}
      availability: >
        {{ states('sensor.fridge_temperature') not in ['unavailable', 'unknown'] }}
      device_class: heat

    - name: Freezer Overheated
      state: >
        {{ states('sensor.freezer_temperature')|float >= -4 }}
      availability: >
        {{ states('sensor.freezer_temperature') not in ['unavailable', 'unknown'] }}
      device_class: heat
